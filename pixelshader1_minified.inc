db 'float a;'
db 'float b;'
db 'float x(float3 f)'
db '{'
db  'float y=2;'
db  'for(;y<14;++y)'
db    'f.xy=max(f.xy,-f.yx),f.xz=max(f.xz,-f.zx),f.yz=max(f.yz,-f.zy),f.yz+=(clamp(a/60-1,0,.2)-clamp(a/58-1.6,0,.2))*float2(-f.z,f.y),f+=f-1;'
db  'return length(f)*.0001;'
db '}'
db 'float4 t(float2 f:vpos):color'
db '{'
db  'float y=2,d=2,z=0,n=a*a*.0002-1;'
db  'float3 i=float3(0,.001,0),l=normalize(.1+i*6000/a-n),c=normalize(cross(-float3(sin(a/27)+cos(a/27),sin(a/27)/2-cos(a/27),0),l)),v=normalize(l*960+(f.x-960)*c+(f.y-540)*cross(l,c));'
db  'for(;i.y<d&&z<2;y++)'
db   'c=n+v*z,z+=d=x(c);'
db  'd=dot(normalize(d-float3(x(c-i.yzz),x(c-i.zyz),x(c-i.zzy))),-v);'
db  'return lit(d,d,40)*(1.6-z)+y*y*.0001*float4(.5,0,1,1)*(1.4-.4*pow(sin(b/2),.5));'
db '}', 0

